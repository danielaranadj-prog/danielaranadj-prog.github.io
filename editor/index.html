<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publicaciones - Blog.Instantetrips</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <script src="https://cdn.tiny.cloud/1/mzaiavt8ne1jnylgt9u8ns2j7xbaofg5gexdmktmbfa09jh3/tinymce/6/tinymce.min.js"
        referrerpolicy="origin"></script>

    <script src="https://unpkg.com/turndown/dist/turndown.js"></script>
    <script src="https://unpkg.com/turndown-plugin-gfm/dist/turndown-plugin-gfm.js"></script>

    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: { slate: { 850: '#1e293b' } }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f3f4f6;
            color: #111;
            font-family: 'Inter', sans-serif;
            transition: background 0.3s, color 0.3s;
        }

        body.dark {
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .logo-adaptive {
            filter: invert(1);
            transition: filter 0.3s;
        }

        .dark .logo-adaptive {
            filter: invert(0);
        }

        .dark .tox-tinymce {
            border-color: #334155 !important;
        }

        /* Glassmorphism */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.1);
        }

        .dark .glass-card {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        /* Animated Gradient Background */
        .gradient-bg {
            background: linear-gradient(-45deg, #f3f4f6, #dbeafe, #fce7f3, #ffedd5, #f3f4f6);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
        }

        .dark .gradient-bg {
            background: linear-gradient(-45deg, #0f172a, #1e1b4b, #1e293b, #0f172a);
            background-size: 400% 400%;
        }

        @keyframes gradientShift {

            0%,
            100% {
                background-position: 0% 50%;
            }

            25% {
                background-position: 50% 100%;
            }

            50% {
                background-position: 100% 50%;
            }

            75% {
                background-position: 50% 0%;
            }
        }

        /* Premium Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #171717 0%, #262626 100%);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .btn-primary:hover::before {
            opacity: 1;
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .dark .btn-primary {
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
        }

        /* Accent Colors */
        .accent-input {
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .accent-input:focus {
            border-color: #f97316;
            box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.15);
            outline: none;
        }

        .text-accent {
            color: #f97316;
        }

        .bg-accent {
            background-color: #f97316;
        }

        /* Modal Animations */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 50;
            display: none;
            place-items: center;
        }

        .modal-overlay.open {
            display: grid;
        }

        .modal-content {
            animation: modalSlideUp 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Enhanced Header */
        .header-enhanced {
            background: linear-gradient(to right, rgba(255, 255, 255, 0.95), rgba(249, 250, 251, 0.95));
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .dark .header-enhanced {
            background: linear-gradient(to right, rgba(15, 23, 42, 0.95), rgba(30, 41, 59, 0.95));
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Interactive Elements */
        .btn-icon {
            transition: all 0.2s ease;
            border-radius: 10px;
        }

        .btn-icon:hover {
            background: rgba(249, 115, 22, 0.1);
            color: #f97316;
            transform: scale(1.05);
        }

        /* Card Hover Effects */
        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px -15px rgba(0, 0, 0, 0.15);
        }

        /* Existing Styles */
        .loader {
            width: 20px;
            height: 20px;
            border: 2px solid #ccc;
            border-top-color: #f97316;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            transition: all 0.3s;
        }

        .dot-green {
            background: #22c55e;
            box-shadow: 0 0 8px #22c55e;
        }

        .dot-yellow {
            background: #eab308;
            box-shadow: 0 0 8px #eab308;
        }

        .dot-red {
            background: #ef4444;
            box-shadow: 0 0 8px #ef4444;
        }

        .prose {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #333;
            max-width: 65ch;
            margin: 0 auto;
        }

        .dark .prose {
            color: #e2e8f0;
        }

        .prose h1 {
            font-size: 2.25em;
            font-weight: 800;
            margin-bottom: 0.5em;
            line-height: 1.2;
        }

        .prose h2 {
            font-size: 1.5em;
            font-weight: 700;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }

        .prose p {
            margin-bottom: 1em;
        }

        .prose img {
            border-radius: 8px;
            margin: 1em 0;
            max-width: 100%;
            height: auto;
        }

        .prose iframe {
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: 8px;
            margin: 1em 0;
        }
    </style>
</head>

<body class="antialiased">

    <div id="preview-modal-mobile" class="modal-overlay z-[60]">
        <div class="bg-white dark:bg-slate-900 w-full h-full flex flex-col">
            <div
                class="flex justify-between items-center p-4 border-b dark:border-slate-700 bg-white dark:bg-slate-900">
                <h3 class="font-bold text-lg flex items-center gap-2"><ion-icon name="eye-outline"></ion-icon> Vista
                    Previa</h3>
                <button onclick="closeMobilePreview()" class="text-3xl p-2"><ion-icon
                        name="close-outline"></ion-icon></button>
            </div>
            <div id="mobile-preview-content"
                class="flex-1 overflow-y-auto p-6 prose dark:prose-invert max-w-none pb-20"></div>
        </div>
    </div>

    <div id="load-post-modal" class="modal-overlay">
        <div
            class="modal-content bg-white dark:bg-slate-900 w-full max-w-2xl rounded-2xl shadow-2xl p-6 flex flex-col max-h-[85vh]">
            <div class="flex justify-between items-center mb-4 border-b dark:border-slate-800 pb-3">
                <h3 class="font-bold text-lg flex items-center gap-2 text-accent"><ion-icon
                        name="folder-open-outline"></ion-icon> Explorar</h3>
                <button onclick="closeLoadModal()" class="btn-icon p-2"><ion-icon name="close-outline"
                        class="text-2xl"></ion-icon></button>
            </div>
            <input type="text" id="search-posts" placeholder="Buscar..."
                class="w-full p-3 bg-gray-50 dark:bg-slate-800 rounded-xl accent-input border border-gray-200 dark:border-slate-700 mb-4"
                oninput="filterPosts()">
            <div id="posts-list" class="space-y-2 overflow-y-auto flex-1 pr-2"></div>
        </div>
    </div>

    <div id="author-modal" class="modal-overlay">
        <div class="modal-content bg-white dark:bg-slate-900 w-full max-w-lg rounded-2xl shadow-2xl p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-lg text-accent">Autores</h3>
                <button onclick="closeAuthorModal()" class="btn-icon p-2"><ion-icon name="close-outline"
                        class="text-2xl"></ion-icon></button>
            </div>
            <div class="space-y-3">
                <input type="text" id="new-auth-name" placeholder="Nombre"
                    class="w-full p-3 rounded-xl accent-input border border-gray-200 dark:bg-slate-800 dark:border-slate-600">
                <input type="text" id="new-auth-role" placeholder="Rol"
                    class="w-full p-3 rounded-xl accent-input border border-gray-200 dark:bg-slate-800 dark:border-slate-600">
                <textarea id="new-auth-bio" rows="2" placeholder="Bio..."
                    class="w-full p-3 rounded-xl accent-input border border-gray-200 dark:bg-slate-800 dark:border-slate-600"></textarea>
                <input type="file" id="new-auth-file" class="w-full text-xs">
                <button onclick="saveNewAuthor()" id="btn-save-auth"
                    class="w-full btn-primary text-white py-3 rounded-xl font-bold">Guardar</button>
            </div>
            <div id="authors-list-container" class="mt-4 pt-4 border-t dark:border-slate-700"></div>
        </div>
    </div>

    <div id="login-section" class="flex items-center justify-center min-h-screen p-4 gradient-bg">
        <div class="w-full max-w-sm text-center glass-card rounded-3xl p-8">
            <div class="mb-8">
                <img src="public/blog.svg" alt="Logo" class="h-14 mx-auto mb-4 logo-adaptive">
                <h1
                    class="text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 dark:from-white dark:to-gray-300 bg-clip-text text-transparent">
                    Editor V6.3</h1>
                <p class="text-xs text-gray-400 mt-1">Panel de Publicaciones</p>
            </div>
            <form id="login-form" class="space-y-4">
                <input type="email" id="email" placeholder="Email"
                    class="w-full p-4 bg-white/50 dark:bg-slate-800/50 rounded-xl accent-input border border-gray-200 dark:border-slate-700"
                    required>
                <input type="password" id="password" placeholder="Contraseña"
                    class="w-full p-4 bg-white/50 dark:bg-slate-800/50 rounded-xl accent-input border border-gray-200 dark:border-slate-700"
                    required>
                <button type="submit" class="w-full btn-primary text-white font-bold py-4 rounded-xl">Entrar</button>
            </form>
            <p id="login-error" class="text-red-500 text-sm mt-4 hidden"></p>
            <p class="text-xs text-gray-400 mt-6">© 2024 Instante Trips</p>
        </div>
    </div>

    <div id="app-section" class="hidden h-[100dvh] flex flex-col">
        <header class="header-enhanced h-16 flex-none z-40">
            <div class="w-full px-4 h-full flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-8 h-8 bg-gradient-to-br from-orange-400 to-orange-600 rounded-lg flex items-center justify-center shadow-lg">
                            <img src="public/blog.svg" alt="Logo" class="h-5 invert">
                        </div>
                        <div>
                            <span class="font-bold text-sm">Editor V6.3</span>
                            <p class="text-[10px] text-gray-500" id="save-status"></p>
                        </div>
                    </div>
                    <!-- Greeting Message (shown after login) -->
                    <div id="greeting-container"
                        class="hidden md:flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-orange-50 to-amber-50 dark:from-orange-900/20 dark:to-amber-900/20 rounded-xl border border-orange-100 dark:border-orange-800/30">
                        <span id="greeting-emoji" class="text-lg"></span>
                        <div>
                            <p id="greeting-text" class="text-xs font-semibold text-gray-700 dark:text-gray-200"></p>
                            <p id="author-role-text" class="text-[10px] text-gray-500"></p>
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-1">
                    <!-- Admin Button (hidden by default, shown only for admin) -->
                    <a id="admin-link" href="../admin/"
                        class="hidden btn-icon flex items-center gap-2 px-3 py-2.5 text-sm font-medium bg-purple-50 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-xl"
                        title="Panel de Administración">
                        <ion-icon name="settings-outline"></ion-icon>
                        <span class="hidden md:inline">Admin</span>
                    </a>
                    <button onclick="toggleDarkMode()" class="btn-icon p-2.5"><ion-icon name="moon-outline"
                            class="text-lg"></ion-icon></button>
                    <button onclick="openMobilePreview()" class="lg:hidden btn-icon p-2.5 text-accent"><ion-icon
                            name="eye-outline" class="text-lg"></ion-icon></button>
                    <button onclick="openLoadModal()"
                        class="btn-icon flex items-center gap-2 px-4 py-2.5 text-sm font-medium"><ion-icon
                            name="folder-open-outline"></ion-icon> Explorar</button>
                    <button id="btn-logout"
                        class="btn-icon p-2.5 text-red-500 hover:!bg-red-50 hover:!text-red-600"><ion-icon
                            name="log-out-outline" class="text-lg"></ion-icon></button>
                </div>
            </div>
        </header>

        <div class="flex-1 flex overflow-hidden">

            <div class="flex-1 overflow-y-auto p-6 pb-32 border-r border-gray-200 dark:border-slate-800 relative">
                <div class="max-w-3xl mx-auto">
                    <div
                        class="bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-2xl p-6 mb-6 shadow-sm card-hover">
                        <div class="flex justify-between mb-4">
                            <h2 class="text-xs font-bold uppercase text-accent tracking-wider">Configuración</h2>
                            <button onclick="clearAll()" class="text-xs text-red-400 hover:underline">Limpiar</button>
                        </div>
                        <div class="space-y-4">
                            <div class="relative">
                                <input type="text" id="post-title"
                                    class="w-full text-2xl font-bold bg-transparent border-b-2 border-gray-200 dark:border-slate-700 py-2 outline-none accent-input"
                                    placeholder="Título del Artículo" oninput="updateSEO()">
                                <div class="absolute right-0 top-3 flex items-center gap-2"><span id="title-count"
                                        class="text-xs text-gray-400">0</span>
                                    <div id="title-seo" class="dot bg-gray-200"></div>
                                </div>
                            </div>
                            <textarea id="post-desc" rows="2"
                                class="w-full text-sm bg-gray-50 dark:bg-slate-800 p-3 rounded outline-none resize-none"
                                placeholder="Descripción SEO..." oninput="updateSEO()"></textarea>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label class="text-xs font-bold text-gray-400">Fecha</label><input type="date"
                                        id="post-date"
                                        class="w-full bg-transparent border-b py-1 dark:border-slate-700"></div>
                                <div><label class="text-xs font-bold text-gray-400 flex justify-between">Autor <span
                                            onclick="openAuthorModal()"
                                            class="text-blue-500 cursor-pointer">+</span></label><select
                                        id="post-author"
                                        class="w-full bg-transparent border-b py-1 dark:border-slate-700">
                                        <option>Cargando...</option>
                                    </select></div>
                            </div>
                            <div class="flex items-center gap-2"><input type="text" id="post-hero"
                                    class="flex-1 text-sm bg-transparent border-b py-1 dark:border-slate-700"
                                    placeholder="Imagen Principal (URL)" oninput="renderLivePreview()"><label
                                    class="cursor-pointer hover:bg-gray-100 p-2 rounded"><ion-icon
                                        name="cloud-upload-outline"></ion-icon><input type="file" class="hidden"
                                        accept="image/*" onchange="uploadHeroImage(this)"></label></div>
                            <div class="flex items-center gap-2"><span class="text-gray-400 text-sm">#</span><input
                                    type="text" id="tag-input" class="flex-1 text-sm bg-transparent outline-none"
                                    placeholder="Tags (Enter)"></div>
                            <div id="tags-container" class="flex flex-wrap gap-2"></div>

                            <!-- Widget Config -->
                            <div class="pt-4 border-t dark:border-slate-800 mt-4">
                                <label
                                    class="text-xs font-bold uppercase text-accent tracking-widest mb-2 block">Widgets
                                    de Viaje ✈️ Copiar código</label>
                                <div class="grid grid-cols-1 gap-2">
                                    <input type="text" id="flight-dest"
                                        class="w-full text-xs bg-gray-50 dark:bg-slate-800 p-2 rounded outline-none border border-transparent focus:border-orange-500 accent-input"
                                        placeholder="Destino Vuelos (Ej: Madrid)">
                                    <input type="text" id="tour-city"
                                        class="w-full text-xs bg-gray-50 dark:bg-slate-800 p-2 rounded outline-none border border-transparent focus:border-orange-500 accent-input"
                                        placeholder="Ciudad Tours (Ej: Madrid)">
                                </div>
                            </div>

                            <!-- Video Button -->
                            <div class="pt-2">
                                <button onclick="insertVideoLink()"
                                    class="flex items-center gap-2 px-3 py-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-lg text-sm font-bold hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors w-full justify-center">
                                    <ion-icon name="logo-youtube" class="text-lg"></ion-icon> Insertar Video (YouTube /
                                    TikTok)
                                </button>
                            </div>
                        </div>
                    </div>

                    <div
                        class="bg-white dark:bg-slate-900 rounded-2xl shadow-lg border border-gray-200 dark:border-slate-800 overflow-hidden min-h-[500px] card-hover">
                        <textarea id="tiny-editor" class="w-full h-full"></textarea>
                    </div>

                    <div class="mt-8 mb-8">
                        <button onclick="publishCurrentPost()"
                            class="w-full btn-primary text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2">
                            <ion-icon name="rocket-outline" class="text-xl"></ion-icon> Publicar Artículo
                        </button>
                    </div>
                </div>
            </div>

            <div class="hidden lg:block w-1/2 bg-white dark:bg-black overflow-y-auto p-12" id="live-preview-column">
                <div class="max-w-2xl mx-auto">
                    <div
                        class="flex items-center gap-2 mb-6 text-xs font-bold uppercase text-gray-400 tracking-widest border-b pb-2">
                        <ion-icon name="eye-outline"></ion-icon> Vista Previa en Vivo
                    </div>
                    <div id="live-preview-content" class="prose dark:prose-invert max-w-none">
                        <h1 class="opacity-50">...</h1>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="toast-container" class="fixed bottom-6 left-6 z-[80] flex flex-col gap-2"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
</body>

</html>
